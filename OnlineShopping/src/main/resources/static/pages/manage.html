<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">
        
        <title>网上杂货商城</title>
        
        <!-- 引入样式 -->
        <link rel="stylesheet" href="../plugins/elementui/index.css">
        <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/vue.js"></script>
        <script src="../plugins/elementui/index.js"></script>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/dashboard.css" rel="stylesheet">
        <script src="../js/axios-0.18.0.js"></script>
        <style type="text/css">
            /* Chart.js */


            @-webkit-keyframes chartjs-render-animation {
                from {
                    opacity: 0.99
                }
                to {
                    opacity: 1
                }
            }

            @keyframes chartjs-render-animation {
                from {
                    opacity: 0.99
                }
                to {
                    opacity: 1
                }
            }

            .chartjs-render-monitor {
                -webkit-animation: chartjs-render-animation 0.001s;
                animation: chartjs-render-animation 0.001s;
            }
        </style>
    </head>
    
    <body>
        <div id="app">
            <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0">
                <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">欢迎来到hcy商城</a>
                <input class="form-control form-control-dark w-100" type="text" placeholder="Search"
                       aria-label="Search">
                <ul class="navbar-nav px-3">
                    <li class="nav-item text-nowrap">
                        <el-dropdown @command="clientLoginOut">
                          <span class="el-dropdown-link">
                            注销<i class="el-icon-arrow-down el-icon--right"></i>
                          </span>
                            <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item command="a">{{this.client.clientName}}</el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                        
                        <style>
                            .el-dropdown-link {
                                cursor: pointer;
                                color: #409EFF;
                            }

                            .el-icon-arrow-down {
                                font-size: 12px;
                            }
                        </style>
                    </li>
                </ul>
            </nav>
            
            <div class="container-fluid">
                <div class="row">
                    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
                        <div class="sidebar-sticky">
                            <ul class="nav flex-column">
                                <li class="nav-item">
                                    <a class="nav-link active" href="http://localhost:8080/pages/dashboard.html">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-home">
                                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                                        </svg>
                                        商城
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-file">
                                            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                                            <polyline points="13 2 13 9 20 9"></polyline>
                                        </svg>
                                        订单
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-shopping-cart">
                                            <circle cx="9" cy="21" r="1"></circle>
                                            <circle cx="20" cy="21" r="1"></circle>
                                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                                        </svg>
                                        购物车
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="http://localhost:8080/pages/manage.html">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-users">
                                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="9" cy="7" r="4"></circle>
                                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                        </svg>
                                        商家管理
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-bar-chart-2">
                                            <line x1="18" y1="20" x2="18" y2="10"></line>
                                            <line x1="12" y1="20" x2="12" y2="4"></line>
                                            <line x1="6" y1="20" x2="6" y2="14"></line>
                                        </svg>
                                        Reports
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-layers">
                                            <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                                            <polyline points="2 17 12 22 22 17"></polyline>
                                            <polyline points="2 12 12 17 22 12"></polyline>
                                        </svg>
                                        Integrations
                                    </a>
                                </li>
                            </ul>
                            
                            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                                <span>Saved reports</span>
                                <a class="d-flex align-items-center text-muted"
                                   href="#">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-plus-circle">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="12" y1="8" x2="12" y2="16"></line>
                                        <line x1="8" y1="12" x2="16" y2="12"></line>
                                    </svg>
                                </a>
                            </h6>
                            <ul class="nav flex-column mb-2">
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-file-text">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                            <polyline points="10 9 9 9 8 9"></polyline>
                                        </svg>
                                        Current month
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-file-text">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                            <polyline points="10 9 9 9 8 9"></polyline>
                                        </svg>
                                        Last quarter
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-file-text">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                            <polyline points="10 9 9 9 8 9"></polyline>
                                        </svg>
                                        Social engagement
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24"
                                             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                             stroke-linejoin="round" class="feather feather-file-text">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                            <polyline points="10 9 9 9 8 9"></polyline>
                                        </svg>
                                        Year-end sale
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                    
                    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
                        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
                            <h2>商品管理</h2>
                        </div>
                        
                        <!--搜索框-->
                        <el-form :inline="true" :model="formInline" class="demo-form-inline">
                            
                            <el-form-item label="商品名">
                                <el-input v-model="formInline.title" placeholder="商品名"></el-input>
                            </el-form-item>
                            <el-form-item label="最低价">
                                <el-input v-model="formInline.beginPrice" placeholder="0"></el-input>
                            </el-form-item>
                            <el-form-item label="最高价">
                                <el-input v-model="formInline.endPrice" placeholder="99999"></el-input>
                            </el-form-item>
                            <el-form-item label="商品类型">
                                <el-select v-model="formInline.typeName" placeholder="所有商品">
                                    <el-option label="全部" value=""></el-option>
                                    <el-option label="图书、音像" value="图书、音像"></el-option>
                                    <el-option label="笔记本" value="笔记本"></el-option>
                                    <el-option label="文件管理" value="文件管理"></el-option>
                                    <el-option label="本册/便签" value="本册/便签"></el-option>
                                    <el-option label="笔类" value="笔类"></el-option>
                                    <el-option label="双肩包" value="双肩包"></el-option>
                                </el-select>
                            </el-form-item>
                            <el-form-item>
                                <div align="center">
                                    <el-button type="primary" @click="selectByCondition()" >搜索</el-button>
                                    <el-button type="primary" @click="">新增</el-button>
                                </div>
                            </el-form-item>
                        </el-form>

                        <!--商品列表-->
                        <template>
                            <el-table
                                    :data="tableData"
                                    height="500"
                                    border
                                    style="width: 100%">
                                <el-table-column
                                        prop="itemType"
                                        label="商品类型"
                                        width="180">
                                </el-table-column>
                                <el-table-column
                                        prop="title"
                                        label="商品名"
                                        width="440">
                                </el-table-column>
                                <el-table-column
                                        prop="price"
                                        label="价格"
                                        width="120">
                                </el-table-column>
                                <el-table-column
                                        prop="num"
                                        label="库存"
                                        width="120">
                                </el-table-column>
                                <el-table-column
                                        prop="sellerName"
                                        label="商家名"
                                        width="150">
                                </el-table-column>
                                <el-table-column
                                        fixed="right"
                                        label="操作"
                                        width="200">
                                    <template slot-scope="scope">
                                        <el-button @click="handleClick(scope.row)" type="text" size="medium">编辑
                                        </el-button>
                                        <el-button type="text" size="medium" @click="isDelete">删除</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </template>
                    
                    
                    </main>
                </div>
            </div>
        </div>
        <!-- Bootstrap core JavaScript
    ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/javascript" src="../js/jquery-3.2.1.slim.min.js"></script>
        <script type="text/javascript" src="../js/popper.min.js"></script>
        <script type="text/javascript" src="../js/bootstrap.min.js"></script>
        
        <!-- Icons -->
        <script type="text/javascript" src="../js/feather.min.js"></script>
        <script>
            feather.replace()
        </script>
        
        <!-- Graphs -->
        <script type="text/javascript" src="../js/Chart.min.js"></script>
        <script>
            var vue = new Vue({
                el: "#app",
                data() {
                    return {
                        tableData: [{
                            itemType: '',
                            title: '',
                            price: '',
                            num: '',
                            sellerName: '',
                            sellPoint: ''
                        }],
                        formInline: {
                            title: '',
                            typeName: '',
                            beginPrice: '',
                            endPrice: '',
                            sellerName: ''
                        },
                        client: {
                            clientName: ''
                        },
                        sellerName: '',
                        
                    }
                },
                mounted() {
                    this.getClientInfo();
                    // this.selectAllBySeller();
                },
                methods: {
                    handleClick(row) {
                        console.log(row);
                    },
                    isDelete() {
                        this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {
                            confirmButtonText: '确定',
                            cancelButtonText: '取消',
                            type: 'warning'
                        }).then(() => {
                            //this.deleteProduct();
                            this.$message({
                                type: 'success',
                                message: '删除成功!'
                            });
                        }).catch(() => {
                            this.$message({
                                type: 'info',
                                message: '已取消删除'
                            });
                        });
                    },
                    deleteProduct() {
                        var _this = this;
                        axios({
                            method: "post",
                            url: "http://localhost:8080/product/deleteStuByAccount",
                            data: student
                        }).then(function () {
                            location.href = "http://localhost:8080/product/manage2.html";
                        })
                    },
                    clearCookie() {
                        var keys = document.cookie.match(/[^ =;]+(?=\=)/g);
                        if (keys) {
                            for (var i = keys.length; i--;) {
                                document.cookie = keys[i] + '=0;path=/;expires=' + new Date(0).toUTCString();//清除当前域名下的,例如：m.kevis.com
                                document.cookie = keys[i] + '=0;path=/;domain=' + document.domain + ';expires=' + new Date(0).toUTCString();//清除当前域名下的,例如 .m.kevis.com
                                document.cookie = keys[i] + '=0;path=/;domain=kevis.com;expires=' + new Date(0).toUTCString();//清除一级域名下的或指定的,例如 .kevis.com
                            }
                        }
                        console.log('已清除');
                    },
                    clientLoginOut(command) {
                        var _this = this;
                        if (command == 'a') {
                            axios({
                                method: "get",
                                url: "http://localhost:8080/user/userLoginOut"
                            }).then(function (res) {
                                alert(res.data.message);
                                _this.clearCookie();//删除所有cookie取消自动登录
                                window.location.reload();
                            })
                        } else {
                            axios({
                                method: "get",
                                url: "http://localhost:8080/seller/sellerLoginOut"
                            }).then(function (res) {
                                alert(res.data.message);
                                window.location.reload();
                            })
                        }
                    },
                    getClientInfo() {
                        var _this = this;
                        axios({
                            method: "get",
                            url: "http://localhost:8080/user/getUserInfo"
                        }).then(function (res) {
                            if (res.data.userInfo != "not_exists") {
                                _this.client.clientName = "用户：" + res.data.userInfo;
                            } else {
                                _this.getSellerInfo();
                            }
                            
                        })
                    },
                    getSellerInfo() {
                        var _this = this;
                        axios({
                            method: "get",
                            url: "http://localhost:8080/seller/getSellerInfo"
                        }).then(function (res) {
                            
                            _this.formInline.sellerName = res.data.sellerInfo;
                            _this.client.clientName = "商家：" + res.data.sellerInfo;
                            _this.selectAllBySeller();
                        })
                    },
                    selectAllBySeller() {
                        var _this = this;
                        axios({
                            method: "post",
                            url: "http://localhost:8080/product/seller",
                            data: _this.formInline
                        }).then(function (res) {
                                _this.tableData = res.data
                            }
                        )
                    },
                    selectByCondition() {
                        var _this = this;
                        axios({
                            method: "post",
                            url: "http://localhost:8080/product/condition",
                            data: _this.formInline
                        }).then(function (res) {
                                console.log(res.data)
                                _this.tableData = res.data
                            }
                        )
                    }
                }
            })
        </script>
    </body>
</html>